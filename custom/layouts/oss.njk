{% extends '_layout.njk' %}
{% import '_macro/sidebar.njk' as sidebar_template with context %}

{% block title %}{{ page.title }}{% endblock %}

{% block class %}archive posts-collapse{% endblock %}

{% block content %}

<style>
  .card-container, .repo-container {
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
    justify-content: space-between;
    margin: 0;
    padding: 0;
  }

  a {
    border: 0;
  }

  .repo {
    width: calc(50% - 10px); /* Two items per row with space for gaps */
    padding: 0;
    margin: 0;
    background-color: transparent;
    text-align: center;
    text-decoration: none; /* Remove underline from the whole card link */
  }

  .repo:hover {
    cursor: pointer;
  }

  .repo img {
    width: 100%;
    height: 150px; /* Set a consistent height for all API images */
    object-fit: contain; /* Ensure the image fits within the height while preserving aspect ratio */
    border-radius: 0;
    margin: 0;
  }

  @media (max-width: 800px) {
    .repo {
      width: calc(100% - 20px); /* Full width on smaller screens */
    }

    .repo img {
      height: 120px; /* Adjust the height for smaller screens */
    }
  }
</style>

<h2>Open Source Projects</h2>
<div class="intro">
  <p>{{ page.content }}</p>
</div>

{% for section in page.github_sections %}
  <section class="github-section">
    <h3>{{ section.title }}</h3>
    {% if section.description %}
      <p>{{ section.description }}</p>
    {% endif %}

    <div class="repo-container">
      {% for repo in section.repos %}
        {% set slash_index = repo.indexOf('/') %}
        {% set username = repo.slice(0, slash_index) %}
        {% set repo_name = repo.slice(slash_index + 1) %}

        <a href="https://github.com/{{ repo }}" class="repo">
          <img
            class="repo-img"
            alt="{{ repo }}"
            src="https://github-readme-stats-ten-plum-80.vercel.app/api/pin/?username={{ username }}&repo={{ repo_name }}&theme=light&description_lines_count=2"
            draggable="false"
          >
        </a>
      {% endfor %}
    </div>
  </section>
{% endfor %}
{% endblock %}

